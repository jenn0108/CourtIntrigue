<events>
  <!-- CONVERSATION EVENTS-->
  <!-- A initiates the approach to B. -->
  <!-- Opening conversation event.
  A = ROOT, B = TARGET.
  ROOT is initiating and has chosen TARGET to talk to.-->
  <event>
    <id>APPROACH_ACTION_EVENT_0</id>
    <description>You approach intent on starting a discussion...</description>
    <requirements>
      <action_id>APPROACH_ACTION</action_id>
    </requirements>
    <exec>
      <set_scope name="TARGET">
        <trigger_event>
          <id>APPROACH_ACTION_EVENT_1</id>
        </trigger_event>
      </set_scope>
    </exec>
  </event>
  <!-- Approach notification event.
  B = ROOT, A = TARGET.
  ROOT can refuse or accept to talk to TARGET.-->
  <event>
    <id>APPROACH_ACTION_EVENT_1</id>
    <description>$Target.Name$ would like to talk to you.</description>
    <options>
      <option>
        <label>Refuse</label>
        <willpower>
          <!-- Refusing conversations is harder when you are shy -->
          <trait_adversion type="SHY_TRAIT" cost="5"/>
        </willpower>
        <exec>
          <set_scope name="TARGET">
            <trigger_event>
              <id>APPROACH_ACTION_EVENT_2</id>
            </trigger_event>
          </set_scope>
          <allow_event_selection/>
        </exec>
      </option>
      <option>
        <label>Accept</label>
        <willpower>
          <!-- Gregarious people always want to talk! -->
          <trait_desire type="GREGARIOUS_TRAIT" cost="5"/>
        </willpower>
        <exec>
          <set_scope name="TARGET">
            <trigger_event>
              <id>APPROACH_ACTION_EVENT_3</id>
            </trigger_event>
          </set_scope>
        </exec>
      </option>
    </options>
  </event>
  <!-- Approach rejection notification
  A = ROOT, B = TARGET
  Conversation is over. B gets a turn still and A does not.-->
  <event>
    <id>APPROACH_ACTION_EVENT_2</id>
    <description>$Target.Name$ refuses to speak with you!</description>
    <exec>
      <apply_opinion_mod>
        <id>REFUSED_TO_SPEAK_TO_OPINION_MOD</id>
        <character>TARGET</character>
      </apply_opinion_mod>
    </exec>
  </event>
  <!-- Approach acceptance notification.
  A = ROOT, B = TARGET
  A now gets to choose a topic.-->
  <event>
    <id>APPROACH_ACTION_EVENT_3</id>
    <description>$Target.Name$ accepts.  What would you like to discuss?</description>
    <options>
      <option>
        <label>Weather</label>
      </option>
      <option>
        <label>Hire for a job...</label>
        <requirements>
          <has_job>KING_JOB</has_job>
          <test_event_options>
            <id>KING_APPROACH_GIVE_JOB_0</id>
            <parameters Candidate="TARGET"/>
          </test_event_options>
        </requirements>
        <exec>
          <trigger_event>
            <id>KING_APPROACH_GIVE_JOB_0</id>
            <parameters Candidate="TARGET"/>
          </trigger_event>
        </exec>
      </option>
      <option>
        <label>Ask for taxes</label>
        <requirements>
          <has_job>STEWARD_JOB</has_job>
          <set_scope name="TARGET">
            <not>
              <has_job>KING_JOB</has_job>
            </not>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="TARGET">
            <trigger_event>
              <id>STEWARD_COLLECT_TAXES_EVENT_0</id>
            </trigger_event>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Pay taxes</label>
        <requirements>
          <set_scope name="TARGET">
            <has_job>STEWARD_JOB</has_job>
          </set_scope>
          <has_gold>20</has_gold>
          <var_eq name="TaxDelinquent">1</var_eq>
        </requirements>
        <exec>
          <spend_gold>20</spend_gold>
          <set_scope name="TARGET">
            <get_gold>20</get_gold>
          </set_scope>
          <set_variable name="TaxDelinquent">0</set_variable>
        </exec>
      </option>
      <option>
        <label>Tell $Target.Name$ about...</label>
        <requirements>
          <has_information/>
        </requirements>
        <exec>
          <set_scope name="TARGET">
            <tell_information>
              <trigger_event>
                <id>APPROACH_ACTION_EVENT_4</id>
                <parameters NewInformation="TOP"/>
              </trigger_event>
            </tell_information>
          </set_scope>
        </exec>
      </option>
    </options>
  </event>
  <!-- Recieving information.
  B = ROOT, A = TARGET
  A has just told B a piece of information.-->
  <event>
    <id>APPROACH_ACTION_EVENT_4</id>
    <description>You learn $NewInformation.Description$</description>
    <parameters>
      <parameter type="information">NewInformation</parameter>
    </parameters>
  </event>
  <!-- King is choosing a job to give to someone
  A = King = ROOT B = Candidate -->
  <event>
    <id>KING_APPROACH_GIVE_JOB_0</id>
    <description>What job would you like to give to $Candidate.Name$?</description>
    <parameters>
      <parameter type="character">Candidate</parameter>
    </parameters>
    <options>
      <option>
        <label>Make them the Chancellor.</label>
        <requirements>
          <set_scope name="Candidate">
            <not>
              <has_job>CHANCELLOR_JOB</has_job>
            </not>
            <job_requirements>CHANCELLOR_JOB</job_requirements>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="Candidate">
            <give_job>CHANCELLOR_JOB</give_job>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Make them the Marshal.</label>
        <requirements>
          <set_scope name="Candidate">
            <not>
              <has_job>MARSHAL_JOB</has_job>
            </not>
            <job_requirements>MARSHAL_JOB</job_requirements>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="Candidate">
            <give_job>MARSHAL_JOB</give_job>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Make them the Spymaster.</label>
        <requirements>
          <set_scope name="Candidate">
            <not>
              <has_job>SPYMASTER_JOB</has_job>
            </not>
            <job_requirements>SPYMASTER_JOB</job_requirements>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="Candidate">
            <give_job>SPYMASTER_JOB</give_job>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Make them the Steward.</label>
        <requirements>
          <set_scope name="Candidate">
            <not>
              <has_job>STEWARD_JOB</has_job>
            </not>
            <job_requirements>STEWARD_JOB</job_requirements>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="Candidate">
            <give_job>STEWARD_JOB</give_job>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Make them the Bishop.</label>
        <requirements>
          <set_scope name="Candidate">
            <not>
              <has_job>BISHOP_JOB</has_job>
            </not>
            <job_requirements>BISHOP_JOB</job_requirements>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="Candidate">
            <give_job>BISHOP_JOB</give_job>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Make them the Falconer.</label>
        <requirements>
          <set_scope name="Candidate">
            <not>
              <has_job>FALCONER_JOB</has_job>
            </not>
            <job_requirements>FALCONER_JOB</job_requirements>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="Candidate">
            <give_job>FALCONER_JOB</give_job>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Make them the Master of the Horse.</label>
        <requirements>
          <set_scope name="Candidate">
            <not>
              <has_job>MASTEROFHORSE_JOB</has_job>
            </not>
            <job_requirements>MASTEROFHORSE_JOB</job_requirements>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="Candidate">
            <give_job>MASTEROFHORSE_JOB</give_job>
          </set_scope>
        </exec>
      </option>
    </options>
  </event>
</events>