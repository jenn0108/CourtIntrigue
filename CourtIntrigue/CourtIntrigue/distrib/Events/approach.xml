<events>
  <!-- CONVERSATION EVENTS-->
  <!-- A initiates the approach to B. -->
  <!-- Opening conversation event.
  A = ROOT, B = TARGET.
  ROOT is initiating and has chosen TARGET to talk to.-->
  <event>
    <id>APPROACH_ACTION_EVENT_0</id>
    <description>You approach intent on starting a discussion...</description>
    <requirements>
      <action_id>APPROACH_ACTION</action_id>
    </requirements>
    <options>
      <option>
        <label>OK</label>
        <exec>
          <set_scope name="TARGET">
            <trigger_event>
              <id>APPROACH_ACTION_EVENT_1</id>
            </trigger_event>
          </set_scope>
        </exec>
      </option>
    </options>
  </event>
  <!-- Approach notification event.
  B = ROOT, A = TARGET.
  ROOT can refuse or accept to talk to TARGET.-->
  <event>
    <id>APPROACH_ACTION_EVENT_1</id>
    <description>$Target.Name$ would like to talk to you.</description>
    <options>
      <option>
        <label>Refuse</label>
        <willpower>
          <!-- Refusing conversations is harder when you are shy -->
          <trait_adversion type="SHY_TRAIT" cost="5"/>
        </willpower>
        <exec>
          <set_scope name="TARGET">
            <trigger_event>
              <id>APPROACH_ACTION_EVENT_2</id>
            </trigger_event>
          </set_scope>
          <allow_event_selection/>
        </exec>
      </option>
      <option>
        <label>Accept</label>
        <willpower>
          <!-- Gregarious people always want to talk! -->
          <trait_desire type="GREGARIOUS_TRAIT" cost="5"/>
        </willpower>
        <exec>
          <set_scope name="TARGET">
            <trigger_event>
              <id>APPROACH_ACTION_EVENT_3</id>
            </trigger_event>
          </set_scope>
        </exec>
      </option>
    </options>
  </event>
  <!-- Approach rejection notification
  A = ROOT, B = TARGET
  Conversation is over. B gets a turn still and A does not.-->
  <event>
    <id>APPROACH_ACTION_EVENT_2</id>
    <description>$Target.Name$ refuses to speak with you!</description>
    <options>
      <option>
        <label>What a jerk...</label>
        <exec>
          <apply_opinion_mod>
            <id>REFUSED_TO_SPEAK_TO_OPINION_MOD</id>
            <character>TARGET</character>
          </apply_opinion_mod>
        </exec>
      </option>
    </options>
  </event>
  <!-- Approach acceptance notification.
  A = ROOT, B = TARGET
  A now gets to choose a topic.-->
  <event>
    <id>APPROACH_ACTION_EVENT_3</id>
    <description>$Target.Name$ accepts.  What would you like to discuss?</description>
    <options>
      <option>
        <label>Weather</label>
        <exec>
          <set_scope name="TARGET">
            <trigger_event>
              <id>APPROACH_ACTION_WEATHER</id>
            </trigger_event>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Hire for a job...</label>
        <requirements>
          <has_job>KING_JOB</has_job>
          <test_event_options>
            <id>KING_APPROACH_GIVE_JOB_0</id>
            <parameters Candidate="TARGET"/>
          </test_event_options>
        </requirements>
        <exec>
          <trigger_event>
            <id>KING_APPROACH_GIVE_JOB_0</id>
            <parameters Candidate="TARGET"/>
          </trigger_event>
        </exec>
      </option>
      <option>
        <label>Ask for taxes</label>
        <requirements>
          <has_job>STEWARD_JOB</has_job>
          <set_scope name="TARGET">
            <not>
              <has_job>KING_JOB</has_job>
            </not>
          </set_scope>
        </requirements>
        <exec>
          <set_scope name="TARGET">
            <trigger_event>
              <id>STEWARD_COLLECT_TAXES_EVENT_0</id>
            </trigger_event>
          </set_scope>
        </exec>
      </option>
      <option>
        <label>Pay taxes</label>
        <requirements>
          <set_scope name="TARGET">
            <has_job>STEWARD_JOB</has_job>
          </set_scope>
          <has_gold>20</has_gold>
          <var_eq name="TaxDelinquent">1</var_eq>
        </requirements>
        <exec>
          <spend_gold>20</spend_gold>
          <set_scope name="TARGET">
            <get_gold>20</get_gold>
            <offset_variable name="TaxesCollected">1</offset_variable>
            <trigger_event>
              <id>STEWARD_GIVEN_OUTSTANDING_TAXES_EVENT</id>
            </trigger_event>
          </set_scope>
          <set_variable name="TaxDelinquent">0</set_variable>
          <observe_information>
            <id>GAVE_TAXES_TO_STEWARD_INFORMATION</id>
            <parameters TaxPayer="ROOT"/>
            <chance>50</chance>
          </observe_information>
        </exec>
      </option>
      <option>
        <label>Remit taxes to the King</label>
        <requirements>
          <has_job>STEWARD_JOB</has_job>
          <set_scope name="TARGET">
            <has_job>KING_JOB</has_job>
          </set_scope>
          <has_gold>100</has_gold>
          <var_ge name="TaxesCollected">5</var_ge>
        </requirements>
        <exec>
          <spend_gold>100</spend_gold>
          <set_scope name="TARGET">
            <get_gold>100</get_gold>
            <offset_variable name="TaxesReceived">50</offset_variable>
            <trigger_event>
              <id>KING_GIVEN_TAXES_FROM_STEWARD_EVENT</id>
            </trigger_event>
          </set_scope>
          <offset_variable name="TaxesCollected">-5</offset_variable>
        </exec>
      </option>
      <option>
        <label>Tell $Target.Name$ about...</label>
        <requirements>
          <has_information/>
        </requirements>
        <exec>
          <set_scope name="TARGET">
            <tell_information>
              <trigger_event>
                <id>APPROACH_ACTION_EVENT_4</id>
                <parameters NewInformation="TOP"/>
              </trigger_event>
            </tell_information>
          </set_scope>
        </exec>
      </option>
    </options>
  </event>
  <!-- Recieving information.
  B = ROOT, A = TARGET
  A has just told B a piece of information.-->
  <event>
    <id>APPROACH_ACTION_EVENT_4</id>
    <description>You learn $NewInformation.Description$</description>
    <parameters>
      <parameter type="information">NewInformation</parameter>
    </parameters>
    <options>
      <option>
        <label>OK</label>
      </option>
    </options>
  </event>
  <!-- Talking about weather.
  B = ROOT, A = TARGET
  A has just decided to talk about weather.-->
  <event>
    <id>APPROACH_ACTION_WEATHER</id>
    <description>You chat about the weather with $Target.Name$.</description>
    <options>
      <option>
        <label>OK</label>
      </option>
    </options>
  </event>
</events>